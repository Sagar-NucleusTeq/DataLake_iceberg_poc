version: 2

models:
  - name: mid_mde_promotion_history
    description: "{{ doc('mid_mde_promotion_history') }}"
    meta:
        needs_data_discovery: False
    tests:
      - dbt_expectations.expect_table_row_count_to_equal_other_table:
          compare_model: ref("staging_mde_promotion_history")
    columns:
      - name: touch_id
        description: "{{ doc('touch_id') }}"
        tests:
          - not_null
      - name: plan_code
        description: "{{ doc('plan_code') }}"
      - name: broadlog_id
        description: "{{ doc('broadlog_id') }}"
        tests:
          - unique
          - not_null
          - dbt_utils.at_least_one
      - name: individual_key
        description: "{{ doc('individual_key') }}"
        tests:
          - not_null
      - name: address_key
        description: "{{ doc('connected_recognition_address_key') }}"
      - name: serial_id
        description: "{{ doc('promotion_serial_id') }}"
      - name: status
        description: "{{ doc('promotion_status_code') }}"
      - name: recipient_state
        description: "{{ doc('promotion_state') }}"
      - name: recipient_city
        description: "{{ doc('promotion_city') }}"
      - name: recipient_zip_code
        description: "{{ doc('promotion_zip') }}"
      - name: is_depromoted
        description: "{{ doc('is_depromoted') }}"
      - name: depromotion_date
        description: "{{ doc('depromotion_date') }}"
      - name: promotion_age
        description: "{{ doc('age_at_promotion') }}"
      - name: package_id
        description: "{{ doc('promotion_package_id') }}"
      - name: tactic_id
        description: "{{ doc('tactic_id') }}"
      - name: cell_id
        description: "{{ doc('cell_id') }}"
      - name: creative_id
        description: "{{ doc('creative_id') }}"
      - name: vendor_code
        description: "{{ doc('promotion_vendor_code') }}"
      - name: finder_number
        description: "{{ doc('finder_number') }}"
      - name: keycode
        description: "{{ doc('keycode_messages') }}"
      - name: promotion_household_milliman_bucket_score
        description: "{{ doc('promotion_hh_milliman_bucket_score') }}"
      - name: promotion_milliman_bucket_score
        description: "{{ doc('promotion_milliman_bucket_score') }}"
      - name: promotion_mille
        description: "{{ doc('promotion_mille') }}"
      - name: promotion_gender
        description: "{{ doc('promotion_gender') }}"
      - name: broadlog_created_date
        description: "{{ doc('event_date') }}"
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: date
      - name: touch_start_date_30days_early
        description: "{{ doc('touch_start_date') }}"
      - name: touch_start_date_90days_out
        description: "{{ doc('touch_start_date') }}"
      - name: campaign_year
        description: "{{ doc('campaign_finance_year') }}"
      - name: campaign_number
        description: "{{ doc('campaign_number') }}"
      - name: campaign
        description: "{{ doc('campaign') }}"
      - name: marketing_program_name
        description: "{{ doc('marketing_program_name') }}"
      - name: campaign_name
        description: "{{ doc('campaign_name') }}"
      - name: marketing_channel_name
        description: "{{ doc('marketing_channel_name') }}"
      - name: marketing_subchannel_name
        description: "{{ doc('marketing_subchannel_name') }}"
        tests:
          # This is an important filter downstream, so it needs to be a valid value
          - not_null
      - name: initiative_description
        description: "{{ doc('initiative_description') }}"
      - name: touch_start_date
        description: "{{ doc('touch_start_date') }}"
        tests:
          - not_null
      - name: target_send_date
        description: "{{ doc('touch_start_date') }}"
        tests:
          - not_null
      - name: target_delivery_deadline
        description: "{{ doc('touch_start_date') }}"
      - name: delivery_contact_date
        description: "{{ doc('delivery_contact_date') }}"
      - name: tactic_name
        description: "{{ doc('tactic_name') }}"
      - name: tactic_type_group
        description: "{{ doc('tactic_type_group') }}"
      - name: tactic_type
        description: "{{ doc('tactic_type') }}"
      - name: product_group
        description: "{{ doc('product_group') }}"
      - name: cell_name
        description: "{{ doc('cell_name') }}"
        tests:
          - not_null
      - name: variant_name
        description: "{{ doc('variant_name') }}"
        tests:
          - not_null
      - name: touch_name
        description: "{{ doc('variant_name') }}"
      - name: marketing_program
        description: "{{ doc('marketing_program_name') }}"
      - name: test_role
        description: "{{ doc('keycode_10th_position') }}"
      - name: last_refreshed_at
        description: "{{ doc('last_refreshed_at') }}"
